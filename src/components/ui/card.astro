---
interface Props {
	title?: string;
	as?: "article" | "section" | "div";
	href?: string;
	variant?: "elevated" | "flat";
	tone?: "neutral" | "primary" | "success" | "danger";
}

const {
	title,
	as = "article",
	href,
	variant = "elevated",
	tone = "neutral",
} = Astro.props as Props;

const isLink = typeof href === "string" && href.length > 0;
const nonLinkTag: "article" | "section" | "div" = [
	"article",
	"section",
	"div",
].includes(as)
	? as
	: "article";

const toneClass = `ui-card--tone ui-card--tone-${tone}`;
const cls = `ui-card ui-card--${variant} ${toneClass}`;
---

{isLink ? (
  <a class={cls} href={href} aria-label={title ? title : undefined}>
    {title && <h3 class="ui-card__title">{title}</h3>}
    <div class="ui-card__content"><slot /></div>
  </a>
) : nonLinkTag === 'article' ? (
  <article class={cls} aria-label={title ? title : undefined}>
    {title && <h3 class="ui-card__title">{title}</h3>}
    <div class="ui-card__content"><slot /></div>
  </article>
) : nonLinkTag === 'section' ? (
  <section class={cls} aria-label={title ? title : undefined}>
    {title && <h3 class="ui-card__title">{title}</h3>}
    <div class="ui-card__content"><slot /></div>
  </section>
) : (
  <div class={cls} aria-label={title ? title : undefined}>
    {title && <h3 class="ui-card__title">{title}</h3>}
    <div class="ui-card__content"><slot /></div>
  </div>
)}

<style>
  .ui-card {
    display: block;
    background: var(--ui-bg);
    color: var(--ui-fg);
    border-radius: var(--ui-radius);
    padding: calc(var(--ui-gap) * 1.25);
    text-decoration: none;
    transition:
      transform 0.12s ease,
      box-shadow 0.12s ease;
  }
  .ui-card--elevated {
    box-shadow: var(--ui-shadow);
    border: 1px solid transparent;
  }
  .ui-card--outline {
    border: 1px solid var(--ui-border);
  }
  .ui-card:hover {
    transform: translateY(-1px);
  }
  .ui-card__title {
    margin: 0 0 calc(var(--ui-gap) * 0.8);
    font:
      600 1.05rem / 1.2 system-ui,
      sans-serif;
  }
  .ui-card__content {
    font:
      400 0.95rem / 1.6 system-ui,
      sans-serif;
  }
  /* tones → 上部にうっすら帯を出す */
  .ui-card--tone::before {
    content: "";
    display: block;
    height: 6px;
    margin: -8px -8px 8px;
    border-radius: 8px 8px 0 0;
    opacity: 0.7;
  }
  .ui-card--tone-neutral::before {
    background: var(--ui-neutral);
  }
  .ui-card--tone-info::before {
    background: var(--ui-info);
  }
  .ui-card--tone-success::before {
    background: var(--ui-success);
  }
  .ui-card--tone-warning::before {
    background: var(--ui-warning);
  }
  .ui-card--tone-danger::before {
    background: var(--ui-danger);
  }
</style>
